import{d as O,g as o,I as H,H as R,c as E,a as l,m as x,h as C,J as I,T as J,L as u,M as s,V as K,F as U,K as W,W as Y,b as k,w as c,f as G,e as j,o as v,_ as z}from"./index-DQyjVy_9.js";import{f as Q}from"./groupservices-CzA038ik.js";import{S as B}from"./StyledButton-Ca-dajib.js";import{E as X,a as Z,i as N}from"./ErrorPopup-BiypUvTI.js";import{M as _}from"./MessagePopup-DeZzRvhk.js";import"./PopUpComponent-DAo_TphJ.js";import"./ErrorMessage-1fHg2YjS.js";const h={class:"calendar-events"},ee={class:"events-content"},te=["value"],ae=["disabled"],le=["disabled"],re={class:"event-buttons"},ne=O({__name:"CalendarEventView",setup(oe){const w="https://syntra-20242025-henk-api.onrender.com/api",{postData:$,putData:A}=Z(),p=o(!1),m=o(""),y=o(!1),f=o(""),i=o(null),g=o(""),r=R(),T=o([]),S=o(!1),M=(n,e)=>{const[a,d,D]=n.split("-").map(Number),[b,L]=e.split(":").map(Number);return new Date(a,d-1,D,b,L).toISOString()},F=()=>{const n=e=>{const a=new Date(e),d=a.getFullYear(),D=String(a.getMonth()+1).padStart(2,"0"),b=String(a.getDate()).padStart(2,"0");return`${d}-${D}-${b}`};if(r.query.id&&(typeof r.query.title=="string"&&(t.value.title=r.query.title),typeof r.query.description=="string"&&(t.value.description=r.query.description),typeof r.query.start=="string"&&(t.value.start=n(r.query.start)),typeof r.query.end=="string"&&(t.value.end=n(r.query.end)),typeof r.query.startTime=="string"&&(t.value.startTime=r.query.startTime),typeof r.query.endTime=="string"&&(t.value.endTime=r.query.endTime),typeof r.query.groupId=="string"&&(t.value.groupId=r.query.groupId)),typeof r.query.selectedDate=="string"){const e=n(r.query.selectedDate);if(t.value.start=e,t.value.end=e,typeof r.query.group_id=="string")if(r.query.group_id==="personal"){const a=T.value.find(d=>d.defaultGroup);a&&(t.value.groupId=String(a.id))}else t.value.groupId=r.query.group_id}},q=j(),t=o({title:"",groupId:"",start:new Date().toISOString().split("T")[0],startTime:"",end:new Date().toISOString().split("T")[0],endTime:"",description:"",allDay:!1});H(async()=>{try{T.value=await Q(),S.value=!!r.query.id,F()}catch(n){m.value="Failed to load groups",f.value=String(n),p.value=!0}});const V=()=>{const n={};typeof r.query.group_id=="string"&&(n.group_id=r.query.group_id),q.push({name:"calendar",query:n})},P=async()=>{const n={title:t.value.title,groupId:t.value.groupId,start:M(t.value.start,t.value.allDay?"00:00":t.value.startTime),end:M(t.value.end,t.value.allDay?"23:59":t.value.endTime),description:t.value.description};if(S.value){const e=await A(`${w}/events/${r.query.id}`,n);if(N(e)){i.value=e.status,f.value=e.message,g.value="Unable to edit event.",y.value=!0,i.value===401&&q.push({name:"login"});return}else p.value=!0,m.value="Event edited"}else{const e=await $(`${w}/events`,n);if(N(e)){i.value=e.status,f.value=e.message,g.value="Unable to add event.",y.value=!0,i.value===401&&q.push({name:"login"});return}else p.value=!0,m.value="Event added"}};return(n,e)=>(v(),E(U,null,[l("div",h,[l("div",ee,[l("h2",null,I(S.value?"Edit an event":"Create a new event"),1),l("form",{onSubmit:J(P,["prevent"])},[l("div",null,[e[9]||(e[9]=l("label",{for:"eventTitle"},"Title event",-1)),u(l("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.value.title=a),id:"eventTitle",type:"text",required:""},null,512),[[s,t.value.title]])]),l("div",null,[e[10]||(e[10]=l("label",{for:"eventGroupId"},"Group",-1)),u(l("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.groupId=a),id:"eventGroupId",required:""},[(v(!0),E(U,null,W(T.value,a=>(v(),E("option",{value:a.id,key:a.id},I(a.defaultGroup?"Personal":a.name),9,te))),128))],512),[[K,t.value.groupId]])]),l("div",null,[e[11]||(e[11]=l("label",{for:"eventStart"},"Start date",-1)),u(l("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.start=a),id:"eventStart",type:"date",required:""},null,512),[[s,t.value.start]])]),l("div",null,[e[12]||(e[12]=l("label",{for:"eventStartTime"},"Start time",-1)),u(l("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.startTime=a),disabled:t.value.allDay,id:"eventStartTime",type:"time"},null,8,ae),[[s,t.value.startTime]])]),l("div",null,[e[13]||(e[13]=l("label",{for:"eventEnd"},"End date",-1)),u(l("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.end=a),id:"eventEnd",type:"date",required:""},null,512),[[s,t.value.end]])]),l("div",null,[e[14]||(e[14]=l("label",{for:"eventEndTime"},"End time",-1)),u(l("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.endTime=a),disabled:t.value.allDay,id:"eventEndTime",type:"time"},null,8,le),[[s,t.value.endTime]])]),l("div",null,[e[15]||(e[15]=l("label",{for:"eventAllDay"},"All day",-1)),u(l("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.allDay=a),id:"eventAllDay",type:"checkbox"},null,512),[[Y,t.value.allDay]])]),l("div",null,[e[16]||(e[16]=l("label",{for:"eventDescription"},"Notes",-1)),u(l("textarea",{"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.description=a),id:"eventDescription",placeholder:"Add notes...",rows:"4",cols:"30"},null,512),[[s,t.value.description]])]),l("div",re,[k(B,{buttonTypeHTML:"submit",type:"save"},{default:c(()=>e[17]||(e[17]=[G("Save")])),_:1}),k(B,{buttonTypeHTML:"reset",type:"negative",onClick:V},{default:c(()=>e[18]||(e[18]=[G("Go Back to Calendar")])),_:1})])],32)])]),p.value?(v(),x(_,{key:0,onClose:V},{default:c(()=>[l("p",null,I(m.value),1)]),_:1})):C("",!0),y.value?(v(),x(X,{key:1,errorExplanation:g.value,errorStatus:i.value,errorMessage:f.value,onClose:e[8]||(e[8]=a=>y.value=!1)},null,8,["errorExplanation","errorStatus","errorMessage"])):C("",!0)],64))}}),fe=z(ne,[["__scopeId","data-v-ab0963fa"]]);export{fe as default};
