import{d as j,g as v,t as L,v as R,x as z,y as H,z as J,A as K,B as O,C as q,D as Q,E as W,I as X,c as l,a as i,m as k,h as C,F as E,K as Y,w as y,e as Z,j as h,u as x,O as G,J as $,b as A,f as B,o,_ as ee}from"./index-BZmOjIu1.js";import{E as te,a as ae,i as I}from"./ErrorPopup-C8aMxlhh.js";import{P as ne}from"./PopUpComponent-D7kd4DBd.js";import{S as D}from"./StyledButton-CceZmSIf.js";import"./ErrorMessage-7kxkp75I.js";const oe={class:"container"},se={key:0},ie={key:1,class:"group-items-container"},le=["onClick"],ue=["src"],re={class:"popup-buttons"},N="/images/default.png",ce=j({__name:"GroupInvites",setup(ve){const g="https://syntra-20242025-henk-api.onrender.com/api",{getData:S,postData:b}=ae(),d=v(!1),p=v(""),u=v(null),f=v("");L.add(R,z,H,J,K,O,q,Q,W);const w=["user","car","dog","bicycle","home","tree","sun","moon","rocket"],r=v([]),a=v(null),m=Z(),U=s=>w.includes(s),V=()=>{m.go(-1)},M=s=>{a.value=s},P=async()=>{if(a.value){const{getAuthToken:s}=h();if(!s())throw new Error("No authentication token found.");const e=await b(`${g}/invitations/${a.value.id}/accept`);I(e)?(u.value=e.status,p.value=e.message,f.value="Unable to accept invitation.",d.value=!0,u.value===401&&m.push({name:"login"})):(r.value=r.value.filter(c=>c.id!==a.value.id),a.value=null)}},T=async()=>{if(a.value){const{getAuthToken:s}=h();if(!s())throw new Error("No authentication token found.");const e=await b(`${g}/invitations/${a.value.id}/reject`);I(e)?(u.value=e.status,p.value=e.message,f.value="Unable to reject invitation.",d.value=!0,u.value===401&&m.push({name:"login"})):(r.value=r.value.filter(c=>c.id!==a.value.id),a.value=null)}},F=async()=>{const{getAuthToken:s}=h();if(!s())throw new Error("No authentication token found.");const e=await S(`${g}/invitations`);if(I(e)){u.value=e.status,p.value=e.message,f.value="Unable to refresh invitations.",d.value=!0,u.value===401&&m.push({name:"login"});return}else r.value=e.map(c=>{const n=c.invitedFor,_=n&&w.includes(n.image??"");return{id:c.id,groupId:n==null?void 0:n.id,name:(n==null?void 0:n.name)??"Unknown group",icon:_?n==null?void 0:n.image:"",tasks:[],image:_||n==null?void 0:n.image,defaultGroup:!1}})};return X(()=>{F()}),(s,t)=>(o(),l(E,null,[i("div",oe,[i("header",null,[t[2]||(t[2]=i("h1",null,"Group invites",-1)),i("button",{onClick:V,class:"close-button"},"âœ–")]),r.value.length===0?(o(),l("div",se,t[3]||(t[3]=[i("p",{class:"no-invites"},"No invites available.",-1)]))):(o(),l("div",ie,[(o(!0),l(E,null,Y(r.value,e=>(o(),l("div",{key:e.id,class:"group-item",onClick:c=>M(e)},[e.icon?(o(),k(x(G),{key:0,icon:["fas",e.icon],class:"group-fa-icon"},null,8,["icon"])):e.image?(o(),l("img",{key:1,src:e.image,alt:"Group Icon",class:"group-img-icon"},null,8,ue)):(o(),l("img",{key:2,src:N,alt:"Default Group Icon",class:"group-img-icon"})),i("span",null,$(e.name),1)],8,le))),128))])),a.value?(o(),k(ne,{key:2,onClose:t[0]||(t[0]=e=>a.value=null)},{default:y(()=>[i("div",null,[t[6]||(t[6]=i("h2",null,"Group Invitation",-1)),U(a.value.icon)?(o(),k(x(G),{key:0,icon:["fas",a.value.icon],class:"popup-icon"},null,8,["icon"])):(o(),l("img",{key:1,src:N,alt:"Default Group Icon",class:"popup-icon"})),i("p",null,$(a.value.name),1),i("div",re,[A(D,{type:"save",class:"accept-btn",onClick:P},{default:y(()=>t[4]||(t[4]=[B("Accept")])),_:1}),A(D,{type:"negative",class:"decline-btn",onClick:T},{default:y(()=>t[5]||(t[5]=[B("Decline")])),_:1})])])]),_:1})):C("",!0)]),d.value?(o(),k(te,{key:0,errorExplanation:f.value,errorStatus:u.value,errorMessage:p.value,onClose:t[1]||(t[1]=e=>d.value=!1)},null,8,["errorExplanation","errorStatus","errorMessage"])):C("",!0)],64))}}),ge=ee(ce,[["__scopeId","data-v-6d09dcbd"]]);export{ge as default};
