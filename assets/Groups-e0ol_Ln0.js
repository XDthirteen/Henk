import{d as Me,g as o,t as Ee,v as X,x as Z,y as ee,z as ae,A as te,B as se,C as oe,D as ne,E as le,G as Se,H as Ae,I as $e,e as Ue,c as p,a as s,m as f,h as m,b as r,w as l,u as ue,J as g,F as R,K as re,f as u,r as Pe,L as ie,M as ve,o as n,p as xe,j as Le,_ as Te}from"./index-BZsSP6UN.js";import{u as Be}from"./groupservices-zeO-KHSc.js";import{P as F}from"./PopUpComponent-Bh-KNhXl.js";import{M as De}from"./ModuleTitleContainer-CAgK18ME.js";import{a as Ve,i as $,E as Ne}from"./ErrorPopup-3feLFr9V.js";import{S as j}from"./SuccessMessage-bslADhyr.js";import{S as d}from"./StyledButton-B_7-0kQX.js";import"./ErrorMessage-cJW0TAv1.js";const Re={class:"container"},Fe={class:"navigation-bar"},je={key:0,class:"invite-badge"},qe={class:"group-container"},ze=["src"],He={class:"group-items-container"},Je=["onClick"],Ke={class:"button-row"},Oe={class:"button-row"},We={class:"custom-dropdown"},Ye={key:1},Qe={key:0,class:"icon-list"},Xe=["onClick"],Ze={class:"button-row"},ce="/images/default.png",ea=Me({name:"GroupsView",__name:"Groups",setup(aa){const q="https://syntra-20242025-henk-api.onrender.com/api",{getData:z,postData:L}=Ve(),y=o(!1),C=o(""),i=o(null),k=o("");Ee.add(X,Z,ee,ae,te,se,oe,ne,le,Se);const H=[X,Z,ee,ae,te,se,oe,ne,le],U=`${q}/groups`,_=Ue();Ae().query.group_id;const{isAuthenticated:de}=Le(),J=Be(),K=o([]),v=o(null),G=o(!1),w=o(!1),E=o(""),I=o(!1),b=o(!1),T=o(!1),S=o(""),M=o(null),O=o([]),P=o(!1),c=o(""),B=o([]),pe=()=>{const a=[...H].sort(()=>.5-Math.random());O.value=a.slice(0,10).map(e=>e.iconName)},fe=()=>{P.value=!P.value},me=a=>{M.value=a,P.value=!1};$e(async()=>{pe(),await D(),await ge()});const D=async()=>{try{const a=await z(`${U}`);if($(a)){i.value=a.status,C.value=a.message,k.value="Unable to fetch groups.",y.value=!0,i.value===401&&_.push({name:"login"});return}K.value=a.filter(e=>!e.defaultGroup).map(e=>{const h=(e.image||"").toString(),x=H.some(t=>t.iconName===h);return{id:e.id,name:e.name,icon:x?h:"user",tasks:e.tasks??[],image:e.image}})}catch(a){console.error("Error fetching groups:",a)}},ge=async()=>{try{const a=await z(`${q}/invitations`);if($(a)){i.value=a.status,C.value=a.message,k.value="Unable to fetch invites.",y.value=!0,i.value===401&&_.push({name:"login"});return}B.value=a}catch(a){console.error("Error fetching invites:",a)}},ye=()=>{_.push({name:"invites"})},W=a=>{_.push({name:"calendar",query:{group_id:a}})},ke=()=>{G.value=!G.value,w.value=!1,I.value=!1,b.value=!1},_e=()=>{w.value=!w.value,G.value=!1,I.value=!1,b.value=!1},he=a=>{v.value=a,I.value=!0},Ce=a=>{v.value=a,b.value=!0},Ge=async()=>{if(!(!E.value.trim()||!v.value||!de.value))try{const a=await L(`${U}/${v.value.id}/invites`,{email:E.value});if($(a)){i.value=a.status,C.value=a.message,k.value="Unable to send invite.",y.value=!0,i.value===401&&_.push({name:"login"}),i.value===400&&(k.value="Unable to send invite. Please check if you have the right email address.");return}c.value=`Invitation sent to ${E.value}!`,setTimeout(()=>{c.value="",I.value=!1},2e3)}catch(a){console.error("Error sending invite:",a)}},Y=()=>{I.value=!1,v.value=null,G.value=!1},we=async()=>{if(v.value)try{const a=await L(`${U}/${v.value.id}/leave`);if($(a)){i.value=a.status,C.value=a.message,k.value="Unable to send invite.",y.value=!0,i.value===401&&_.push({name:"login"});return}c.value=`You have left the group "${v.value.name}"!`,setTimeout(()=>{c.value="",b.value=!1},2e3),await D()}catch(a){console.error("Error leaving group:",a)}},Q=()=>{b.value=!1,v.value=null,w.value=!1},Ie=()=>{T.value=!0},V=()=>{T.value=!1,S.value="",M.value=null},be=async()=>{if(!S.value.trim()||!M.value){alert("Vul alle velden in.");return}try{const a={name:S.value,image:M.value},e=await L(U,a);if($(e)){i.value=e.status,C.value=e.message,k.value="Unable to add group.",y.value=!0,i.value===401&&_.push({name:"login"});return}c.value="Group successfully added!",setTimeout(()=>{c.value="",V()},2e3),await D()}catch(a){console.error("Error adding group:",a)}};return(a,e)=>{var x,N;const h=Pe("font-awesome-icon");return n(),p(R,null,[s("div",Re,[s("header",null,[r(De,null,{default:l(()=>e[4]||(e[4]=[u("Groups")])),_:1})]),s("nav",Fe,[r(d,{type:"secundary",onClick:Ie},{default:l(()=>e[5]||(e[5]=[u("➕ Add Group")])),_:1}),r(d,{type:"secundary",onClick:ke},{default:l(()=>e[6]||(e[6]=[u("📨 Invite Members")])),_:1}),r(d,{type:"secundary",onClick:_e},{default:l(()=>e[7]||(e[7]=[u("🗑️ Leave Group")])),_:1}),r(d,{type:"secundary",onClick:ye,class:"invite-bell-btn"},{default:l(()=>[r(h,{icon:["fas","bell"]}),B.value.length>0?(n(),p("span",je,g(B.value.length),1)):m("",!0)]),_:1})]),s("div",qe,[s("div",{class:"main-group",onClick:e[0]||(e[0]=t=>W("personal"))},[s("img",{src:((x=ue(J).meGroup)==null?void 0:x.icon)||ce,alt:"Personal"},null,8,ze),s("span",null,g(((N=ue(J).meGroup)==null?void 0:N.name)||"My Agenda"),1)]),s("div",He,[(n(!0),p(R,null,re(K.value,t=>{var A;return n(),p("div",{key:t.id,class:xe(["group-item",{selectable:G.value||w.value,selected:((A=v.value)==null?void 0:A.id)===t.id}]),onClick:sa=>G.value?he(t):w.value?Ce(t):W(String(t.id))},[t.icon?(n(),f(h,{key:0,icon:["fas",t.icon]},null,8,["icon"])):(n(),p("img",{key:1,src:ce,alt:"Default Group Icon"})),s("span",null,g(t.name),1)],10,Je)}),128))])]),I.value?(n(),f(F,{key:0,onClose:Y},{default:l(()=>{var t;return[s("h3",null,"Invite to: "+g((t=v.value)==null?void 0:t.name),1),ie(s("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=A=>E.value=A),placeholder:"Enter User Email",class:"input-field"},null,512),[[ve,E.value]]),s("div",Ke,[r(d,{type:"save",class:"send-btn",onClick:Ge},{default:l(()=>e[8]||(e[8]=[u("Send Invite")])),_:1}),r(d,{type:"negative",class:"cancel-btn",onClick:Y},{default:l(()=>e[9]||(e[9]=[u("Cancel")])),_:1})]),c.value?(n(),f(j,{key:0},{default:l(()=>[u(g(c.value),1)]),_:1})):m("",!0)]}),_:1})):m("",!0),b.value?(n(),f(F,{key:1,onClose:Q},{default:l(()=>{var t;return[s("h3",null,"Wil je "+g((t=v.value)==null?void 0:t.name)+" verlaten?",1),s("div",Oe,[r(d,{type:"save",onClick:we},{default:l(()=>e[10]||(e[10]=[u("Bevestig")])),_:1}),r(d,{type:"negative",onClick:Q},{default:l(()=>e[11]||(e[11]=[u("Annuleer")])),_:1})]),c.value?(n(),f(j,{key:0},{default:l(()=>[u(g(c.value),1)]),_:1})):m("",!0)]}),_:1})):m("",!0),T.value?(n(),f(F,{key:2,onClose:V},{default:l(()=>[e[14]||(e[14]=s("h3",null,"Nieuwe Groep Aanmaken",-1)),ie(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>S.value=t),placeholder:"Groepsnaam",class:"input-field"},null,512),[[ve,S.value]]),s("div",We,[s("div",{class:"selected-icon",onClick:fe},[M.value?(n(),f(h,{key:0,icon:["fas",M.value]},null,8,["icon"])):(n(),p("span",Ye,"Selecteer een icoon"))]),P.value?(n(),p("ul",Qe,[(n(!0),p(R,null,re(O.value,t=>(n(),p("li",{key:t,onClick:A=>me(t),class:"icon-item"},[r(h,{icon:["fas",t]},null,8,["icon"]),u(" "+g(t),1)],8,Xe))),128))])):m("",!0)]),s("div",Ze,[r(d,{type:"save",onClick:be},{default:l(()=>e[12]||(e[12]=[u("Groep Toevoegen")])),_:1}),r(d,{type:"negative",onClick:V},{default:l(()=>e[13]||(e[13]=[u("Annuleer")])),_:1})]),c.value?(n(),f(j,{key:0},{default:l(()=>[u(g(c.value),1)]),_:1})):m("",!0)]),_:1})):m("",!0)]),y.value?(n(),f(Ne,{key:0,errorExplanation:k.value,errorStatus:i.value,errorMessage:C.value,onClose:e[3]||(e[3]=t=>y.value=!1)},null,8,["errorExplanation","errorStatus","errorMessage"])):m("",!0)],64)}}}),da=Te(ea,[["__scopeId","data-v-ce6295e0"]]);export{da as default};
